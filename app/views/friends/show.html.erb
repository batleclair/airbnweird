<div class="container mt-3 mb-3">
  <div class="d-flex">
    <div>
      <% if @friend.photo.attached? %>
        <div class="friend-large-photo" style="background-image: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.3)), url('<%= cl_image_path @friend.photo.key, height: 250, crop: :fill %>')"></div>
      <% else %>
        <div class="friend-large-photo" style="background-image: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.3)), url('<%= image_tag 'https://picsum.photos/200', height: 200, width: 100, crop: :fill %>')"></div>
      <% end %>

      <div class="friend-stats">
        <p><i class="fas fa-home"></i> Price <%= @friend.price %> euros</p>
        <p class="star-violet"><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-regular fa-star-half-stroke"></i><i class="fa-regular fa-star"></i></p>
      </div>
    </div>
    <div class="ms-3 me-3 col-xs-9 friend-details">
      <h3>Name: <%= @friend.name %></h3>
      <h6>Category: <%= @friend.category %></h6>
      <h6>Native language: <%= @friend.language %></h6>
      <hr>
      <div>
        <h5><strong>Description</strong></h5>
        <p>Description: <%= @friend.description %></p>
        <hr>
        <h4><strong> Friend owner</strong></h4>
        <p>Owner's name: <%= @friend.user.name %></p>
        <%= link_to "Edit this friend", edit_friend_path(@friend), class:"btn btn-primary", method: :edit if policy(@friend).edit? %>
        <%= button_to "Destroy this friend", @friend, method: :delete if policy(@friend).destroy? %>
      </div>
    </div>
    <% unless policy(@friend).edit? %>
      <div class="card p-4 position-relative d-flex flex-column justify-content-between " id="reservation" data-controller="duration">
        <div>
          <div class="d-flex">
            <h2 data-duration-target="price" ><%= @friend.price %></h2>
            <p class="align-bottom">â‚¬ / day</p>
          </div>
          <%= simple_form_for([@friend, @booking], data: { turbo:"false" }) do |f| %>
            <%= f.input :start_date, as: :string, required: false, input_html: {class: "datepicker", data: { duration_target: "startDate"}} %>
            <%= f.input :end_date, as: :string, required: false, input_html: {class: "datepicker", data: { duration_target: "endDate", action: "duration#price" }} %>
            <div class='form-actions-reservation'>
              <%= f.submit class: "btn btn-flat", value: "Reserve" %>
            </div>
          <% end %>
        </div>
        <div class="d-flex justify-content-between border-top">
          <p><strong>Total</strong></p>
          <p data-duration-target = "totalPrice"></p>
        </div>
      </div>
    <% end %>
  </div>
   <div class="col-xs-9">
      <hr>
      <h5>Exact location information is provided after a booking is confirmed.</h5>
      <div
        data-controller="map"
        style="width: 100%;
        height: 400px;"
        data-map-markers-value="<%= @markers.to_json %>"
        data-map-api-key-value="<%= ENV['MAPBOX_API_KEY'] %>"
      ></div>
    </div>
</div>
